#!/usr/bin/env ruby
# coding: utf-8

require "benchmark"
require "open-uri"

%w[byk srbovanje].each do |gem|
  begin
    require gem
  rescue LoadError
    abort "Can't load \"#{gem}\".\ngem install #{gem}?"
  end
end

ascii   = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam egestas finibus lorem."
mixed   = '<meta name="description" content="ПОЛИТИКА Online, најстарији дневни лист на Балкану"/>'
pangram = "Фијуче ветар у шибљу, леди пасаже и куће иза њих и гунђа у оџацима. А сад да изравнамо."
article = ""

open("http://www.politika.rs/") { |io| article = io.read }

samples = {
  :empty   => "",
  :ascii   => ascii   * 100,
  :mixed   => mixed   * 100,
  :pangram => pangram * 100,
  :long    => article
}

n = 100

Benchmark.bmbm do |x|
  samples.each do |label, sample|
    x.report("Srbovanje -- #{label}:") { n.times { sample.latinicom } }
    x.report("Byk       -- #{label}:") { n.times { sample.to_latin  } }
  end
end

=begin
                            user     system      total        real
Srbovanje -- empty:     0.000000   0.000000   0.000000 (  0.000443)
Byk       -- empty:     0.000000   0.000000   0.000000 (  0.000027)
Srbovanje -- ascii:     0.570000   0.000000   0.570000 (  0.574047)
Byk       -- ascii:     0.070000   0.000000   0.070000 (  0.069646)
Srbovanje -- mixed:     0.630000   0.000000   0.630000 (  0.625497)
Byk       -- mixed:     0.090000   0.000000   0.090000 (  0.087970)
Srbovanje -- pangram:   0.670000   0.010000   0.680000 (  0.672947)
Byk       -- pangram:   0.090000   0.000000   0.090000 (  0.092365)
Srbovanje -- long:      4.250000   0.020000   4.270000 (  4.282203)
Byk       -- long:      0.530000   0.010000   0.540000 (  0.536597)

=end
