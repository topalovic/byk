#!/usr/bin/env ruby
# coding: utf-8

require "benchmark"
require "open-uri"

%w[byk srbovanje].each do |gem|
  begin
    require gem
  rescue LoadError
    abort "Can't load \"#{gem}\".\ngem install #{gem}?"
  end
end

ascii   = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam egestas finibus lorem."
mixed   = '<meta name="description" content="ПОЛИТИКА Online, најстарији дневни лист на Балкану"/>'
pangram = "Фијуче ветар у шибљу, леди пасаже и куће иза њих и гунђа у оџацима. А сад да изравнамо."
article = ""

open("http://www.politika.rs/") { |io| article = io.read }

samples = {
  :empty   => "",
  :ascii   => ascii   * 100,
  :mixed   => mixed   * 100,
  :pangram => pangram * 100,
  :long    => article
}

n = 100

Benchmark.bmbm do |x|
  samples.each do |label, sample|
    x.report("Srbovanje -- #{label}:") { n.times { sample.latinicom } }
    x.report("Byk       -- #{label}:") { n.times { sample.to_latin  } }
  end
end

=begin
                            user     system      total        real
Srbovanje -- empty:     0.000000   0.000000   0.000000 (  0.000087)
Byk       -- empty:     0.000000   0.000000   0.000000 (  0.000009)
Srbovanje -- ascii:     0.320000   0.000000   0.320000 (  0.322403)
Byk       -- ascii:     0.010000   0.000000   0.010000 (  0.008082)
Srbovanje -- mixed:     0.360000   0.000000   0.360000 (  0.360589)
Byk       -- mixed:     0.020000   0.000000   0.020000 (  0.019448)
Srbovanje -- pangram:   0.380000   0.000000   0.380000 (  0.379505)
Byk       -- pangram:   0.030000   0.000000   0.030000 (  0.030226)
Srbovanje -- long:      2.460000   0.000000   2.460000 (  2.460583)
Byk       -- long:      0.090000   0.000000   0.090000 (  0.088677)

ruby 2.2.0p0 [x86_64-linux]

=end
